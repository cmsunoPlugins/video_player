/*@file Video plugin for CKEditor Copyright (C) 2011 Alfonso Martínez de Lizarrondo */
// MODIF POUR CMSUno : suppression lang ES - suppression commentaire linkTemplate & fallbackTemplate - toolbar:'cmsuno'
(function(){CKEDITOR.plugins.add('video',{lang:['en'],getPlaceholderCss:function(){return'img.cke_video'+'{'+'background-image: url('+CKEDITOR.getUrl(this.path+'images/placeholder.png')+');'+'background-position: center center;'+'background-repeat: no-repeat;'+'background-color:gray;'+'border: 1px solid #a9a9a9;'+'width: 80px;'+'height: 80px;'+'}'},onLoad:function(){if(CKEDITOR.addCss)CKEDITOR.addCss(this.getPlaceholderCss())},init:function(editor){var lang=editor.lang.video;if(typeof editor.element.data=='undefined'){alert('The "video" plugin requires CKEditor 3.5 or newer');return}CKEDITOR.dialog.add('video',this.path+'dialogs/video.js');editor.addCommand('Video',new CKEDITOR.dialogCommand('video'));editor.ui.addButton('Video',{label:lang.toolbar,command:'Video',icon:this.path+'images/icon.png',toolbar:'cmsuno'});if(editor.addCss)editor.addCss(this.getPlaceholderCss());if(editor.addMenuItems){editor.addMenuItems({video:{label:lang.properties,command:'Video',group:'flash'}})}editor.on('doubleclick',function(evt){var element=evt.data.element;if(element.is('img')&&element.data('cke-real-element-type')=='video')evt.data.dialog='video'});if(editor.contextMenu){editor.contextMenu.addListener(function(element,selection){if(element&&element.is('img')&&!element.isReadOnly()&&element.data('cke-real-element-type')=='video')return{video:CKEDITOR.TRISTATE_OFF}})}CKEDITOR.dtd.$empty['cke:source']=1;CKEDITOR.dtd.$empty['source']=1;editor.lang.fakeobjects.video=lang.fakeObject},afterInit:function(editor){var dataProcessor=editor.dataProcessor,htmlFilter=dataProcessor&&dataProcessor.htmlFilter,dataFilter=dataProcessor&&dataProcessor.dataFilter;dataFilter.addRules({elements:{$:function(realElement){if(realElement.name=='video'){realElement.name='cke:video';for(var i=0;i<realElement.children.length;i++){if(realElement.children[i].name=='source')realElement.children[i].name='cke:source'}var fakeElement=editor.createFakeParserElement(realElement,'cke_video','video',false),fakeStyle=fakeElement.attributes.style||'';var width=realElement.attributes.width,height=realElement.attributes.height,poster=realElement.attributes.poster;if(typeof width!='undefined')fakeStyle=fakeElement.attributes.style=fakeStyle+'width:'+CKEDITOR.tools.cssLength(width)+';';if(typeof height!='undefined')fakeStyle=fakeElement.attributes.style=fakeStyle+'height:'+CKEDITOR.tools.cssLength(height)+';';if(poster)fakeStyle=fakeElement.attributes.style=fakeStyle+'background-image:url('+poster+');';return fakeElement}}}})}});var en={toolbar:'Video',dialogTitle:'Video properties',fakeObject:'Video',properties:'Edit video',widthRequired:'Width field cannot be empty',heightRequired:'Height field cannot be empty',poster:'Poster image',sourceVideo:'Source video',sourceType:'Video type',linkTemplate:'',fallbackTemplate:''};if(CKEDITOR.skins){en={video:en}}CKEDITOR.plugins.setLang('video','en',en)})();